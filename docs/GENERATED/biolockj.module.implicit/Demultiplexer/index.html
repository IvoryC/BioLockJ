<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Ivory Blakley">
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Demultiplexer - BioLockJ User Guide</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Demultiplexer";
    var mkdocs_page_input_path = "GENERATED/biolockj.module.implicit/Demultiplexer.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> BioLockJ User Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../Getting-Started/">Getting Started</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Pipeline Componenets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../Configuration/">Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../General-Properties/">General Properties</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../Built-in-modules/">Modules</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Metadata/">Metadata</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../Dependencies/">Dependencies</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Configuration Details</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../Cluster/">cluster</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../Docker/">docker</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../Input/">input</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../Metadata/">metadata</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../R/">r</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../Report.md">report</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../Script/">script</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../Validation/">validation</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Features</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../Commands/">Commands</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../Check-Dependencies/">Check Dependencies</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../Failure-Recovery/">Failure Recovery</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Validation/">Validation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../Building-Modules/">Building Modules</a>
                </li>
                <li class="">
                    
    <a class="" href="../../BioLockJ-Api/">BioLockJ API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../biolockj-help/">BioLockJ help menu</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../Supported-Environments/">Environments</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../Example-Pipeline/">Example Pipeline</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../FAQ/">FAQ</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">BioLockJ User Guide</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
    
    <li>Demultiplexer</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="demultiplexer">Demultiplexer<a class="headerlink" href="#demultiplexer" title="Permanent link">#</a></h1>
<p>Add to module run order:                  <br />
<code>#BioModule biolockj.module.implicit.Demultiplexer</code></p>
<h2 id="description">Description<a class="headerlink" href="#description" title="Permanent link">#</a></h2>
<p>Demultiplex samples into separate files for each sample.</p>
<h2 id="properties">Properties<a class="headerlink" href="#properties" title="Permanent link">#</a></h2>
<p><em>Properties are the <code>name=value</code> pairs in the <a href="../../../Configuration#properties">configuration</a> file.</em>                   </p>
<h3 id="demultiplexer-properties">Demultiplexer properties:<a class="headerlink" href="#demultiplexer-properties" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><em>demultiplexer.barcodeCutoff</em></td>
<td align="left"><em>numeric</em> <br>Options: (0.0 - 1.0); if defined, pipeline will fail if the percentage of reads with a barcode is less than this cutoff. -&gt; (DeuxUtil)<br><em>default:</em>  0.05</td>
</tr>
<tr>
<td align="left"><em>demultiplexer.barcodeRevComp</em></td>
<td align="left"><em>boolean</em> <br>Options: Y/N. Use reverse compliment of metadata.barcodeColumn if demultimplexer.strategy = barcode_in_header or barcode_in_seq. -&gt; (DeuxUtil)<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>demultiplexer.strategy</em></td>
<td align="left"><em>string</em> <br>Options: barcode_in_header, barcode_in_seq, id_in_header, do_not_demux.If using barcodes, they must be provided in the metadata file within column defined by <em>metadata.barcodeColumn</em>. -&gt; (DeuxUtil)<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>metadata.barcodeColumn</em></td>
<td align="left"><em>string</em> <br>metadata column with identifying barcodes -&gt; Values must be unique.<br><em>default:</em>  BarcodeSequence</td>
</tr>
<tr>
<td align="left"><em>metadata.filePath</em></td>
<td align="left"><em>string</em> <br>If absolute file path, use file as metadata.<br>If directory path, must find exactly 1 file within, to use as metadata. -&gt; Used for matching sample id to barcodes.<br><em>default:</em>  <em>null</em></td>
</tr>
</tbody>
</table>
<h3 id="general-properties-applicable-to-this-module">General properties applicable to this module:<a class="headerlink" href="#general-properties-applicable-to-this-module" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th align="left">Property</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><em>cluster.batchCommand</em></td>
<td align="left"><em>string</em> <br>Terminal command used to submit jobs on the cluster<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>cluster.jobHeader</em></td>
<td align="left"><em>string</em> <br>Header written at top of worker scripts<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>cluster.modules</em></td>
<td align="left"><em>list</em> <br>List of cluster modules to load at start of worker scripts<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>cluster.prologue</em></td>
<td align="left"><em>string</em> <br>To run at the start of every script after loading cluster modules (if any)<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>cluster.statusCommand</em></td>
<td align="left"><em>string</em> <br>Terminal command used to check the status of jobs on the cluster<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>demultiplexer.barcodeCutoff</em></td>
<td align="left"><em>numeric</em> <br>Options: (0.0 - 1.0); if defined, pipeline will fail if the percentage of reads with a barcode is less than this cutoff. -&gt; (DeuxUtil)<br><em>default:</em>  0.05</td>
</tr>
<tr>
<td align="left"><em>demultiplexer.barcodeRevComp</em></td>
<td align="left"><em>boolean</em> <br>Options: Y/N. Use reverse compliment of metadata.barcodeColumn if demultimplexer.strategy = barcode_in_header or barcode_in_seq. -&gt; (DeuxUtil)<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>demultiplexer.strategy</em></td>
<td align="left"><em>string</em> <br>Options: barcode_in_header, barcode_in_seq, id_in_header, do_not_demux.If using barcodes, they must be provided in the metadata file within column defined by <em>metadata.barcodeColumn</em>. -&gt; (DeuxUtil)<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>docker.saveContainerOnExit</em></td>
<td align="left"><em>boolean</em> <br>If Y, docker run command will NOT include the --rm flag<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>docker.verifyImage</em></td>
<td align="left"><em>boolean</em> <br>In check dependencies, run a test to verify the docker image.<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>metadata.barcodeColumn</em></td>
<td align="left"><em>string</em> <br>metadata column with identifying barcodes -&gt; Values must be unique.<br><em>default:</em>  BarcodeSequence</td>
</tr>
<tr>
<td align="left"><em>metadata.filePath</em></td>
<td align="left"><em>string</em> <br>If absolute file path, use file as metadata.<br>If directory path, must find exactly 1 file within, to use as metadata. -&gt; Used for matching sample id to barcodes.<br><em>default:</em>  <em>null</em></td>
</tr>
<tr>
<td align="left"><em>pipeline.defaultDemultiplexer</em></td>
<td align="left"><em>string</em> <br>Java class name for default module used to demultiplex data<br><em>default:</em>  biolockj.module.implicit.Demultiplexer</td>
</tr>
<tr>
<td align="left"><em>script.defaultHeader</em></td>
<td align="left"><em>string</em> <br>Store default script header for MAIN script and locally run WORKER scripts.<br><em>default:</em>  #!/bin/bash</td>
</tr>
<tr>
<td align="left"><em>script.numThreads</em></td>
<td align="left"><em>integer</em> <br>Used to reserve cluster resources and passed to any external application call that accepts a numThreads parameter.<br><em>default:</em>  8</td>
</tr>
<tr>
<td align="left"><em>script.numWorkers</em></td>
<td align="left"><em>integer</em> <br>Set number of samples to process per script (if parallel processing)<br><em>default:</em>  1</td>
</tr>
<tr>
<td align="left"><em>script.permissions</em></td>
<td align="left"><em>string</em> <br>Used as chmod permission parameter (ex: 774)<br><em>default:</em>  770</td>
</tr>
<tr>
<td align="left"><em>script.timeout</em></td>
<td align="left"><em>integer</em> <br>Sets # of minutes before worker scripts times out.<br><em>default:</em>  <em>null</em></td>
</tr>
</tbody>
</table>
<h2 id="details">Details<a class="headerlink" href="#details" title="Permanent link">#</a></h2>
<p>When BioLockJ detects that the input is multiplexed data, BioLockJ automatically adds a Demultiplexer as the 2nd module, using the class path supplied via the <code>pipeline.defaultDemultiplexer</code> property. (<a href="../biolockj.module.implicit/ImportMetadata">ImportMetadata</a> is added as the first module.)                   </p>
<p>This Demultiplexer requires that the sequence headers contain either the Sample ID or an identifying barcode.  Optionally, the barcode can be contained in the sequence itself.  If your data does not conform to one of the following scenarios you will need to pre-process your sequence data to conform to a valid format.                   </p>
<h4 id="if-samples-are-not-identified-by-sample-id-in-the-sequence-headers">If samples are not identified by sample ID in the sequence headers:<a class="headerlink" href="#if-samples-are-not-identified-by-sample-id-in-the-sequence-headers" title="Permanent link">#</a></h4>
<ol>
<li>Set <em>demux.strategy</em>=id_in_header                   </li>
<li>Set <em>input.trimPrefix</em> to a character string that precedes the sample ID <strong>for all samples</strong>.                   </li>
<li>Set <em>input.trimSuffix</em> to a character string that comes after the sample ID <strong>for all samples</strong>.                   </li>
</ol>
<p><strong>Sample IDs</strong> = mbs1, mbs2, mbs3, mbs4                   </p>
<p><strong>Scenario 1: Your multiplexed files include Sample IDs in the fastq sequence headers</strong>                    </p>
<pre><code>@mbs1_134_M01825:384:000000000-BCYPK:1:2106:23543:1336 1:N:0                   
@mbs2_12_M02825:384:000000000-BCYPK:1:1322:23543:1336 1:N:0                   
@mbs3_551_M03825:384:000000000-BCYPK:1:1123:23543:1336 1:N:0                   
@mbs4_1234_M04825:384:000000000-BCYPK:1:9872:23543:1336 1:N:0
</code></pre>
<p><strong>Required Config</strong>                 <br />
+ <em>input.trimPrefix</em>=@                 <br />
+ <em>input.trimSuffix</em>=_                   </p>
<p>All characters before (and including) the 1st "@" in the sequence header are trimmed                   </p>
<p>All characters after (and including) the 1st "_" in the sequence header are trimmed                   </p>
<h4 id="if-samples-are-identified-by-barcode-in-the-header-or-sequence">If samples are identified by barcode (in the header or sequence):<a class="headerlink" href="#if-samples-are-identified-by-barcode-in-the-header-or-sequence" title="Permanent link">#</a></h4>
<ol>
<li>Set <em>demux.strategy</em>=barcode_in_header or <em>demux.strategy</em>=barcode_in_seq                   </li>
<li>Set <em>metadata.filePath</em> to metadata file path.                   </li>
<li>Set <em>metadata.barcodeColumn</em> to the barcode column name.                   </li>
<li>If the metadata barcodes are listed as reverse compliments, set <em>demultiplexer.barcodeRevComp</em>=Y.                   </li>
</ol>
<p>The metadata file must be prepared by adding a unique sequence barcode in the <em>metadata.barcodeColumn</em> column.  This information is often available in a mapping file provided by the sequencing center that produced the raw data.                   </p>
<p><strong>Metadata file</strong>                    </p>
<table>
<thead>
<tr>
<th align="left">ID</th>
<th align="left">BarcodeColumn</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">mbs1</td>
<td align="left">GAGGCATGACTGGATA</td>
</tr>
<tr>
<td align="left">mbs2</td>
<td align="left">NAGGCATATTTGCACA</td>
</tr>
<tr>
<td align="left">mbs3</td>
<td align="left">GACCCATGACTGCATA</td>
</tr>
<tr>
<td align="left">mbs4</td>
<td align="left">TACCCAGCACCGCTTA</td>
</tr>
</tbody>
</table>
<p><strong>Scenario 2: Your multiplexed files include a barcode in the headers</strong>                   </p>
<pre><code>@M01825:384:000000000-BCYPK:1:2106:23543:1336 1:N:0:GAGGCATGACTGGATA                   
@M01825:384:000000000-BCYPK:1:1322:23543:1336 1:N:0:NAGGCATATTTGCACA                   
@M01825:384:000000000-BCYPK:1:1123:23543:1336 1:N:0:GACCCATGACTGCATA                   
@M01825:384:000000000-BCYPK:1:9872:23543:1336 1:N:0:TACCCAGCACCGCTTA
</code></pre>
<p><strong>Required Config</strong>                 <br />
+ <em>demux.strategy</em>=barcode_in_header                 <br />
+ <em>metadata.barcodeColumn</em>=BarcodeColumn                 <br />
+ <em>metadata.filePath</em>=<path to metadata file>                   </p>
<p><strong>Scenario 3: Your multiplexed files include a barcode in the sequences</strong>                   </p>
<pre><code>&gt;M01825:384:000000000-BCYPK:1:2106:23543:1336 1:N:0:                   
    GAGGCATGACTGGATATATACATACTGAGGCATGACTACTTACTATAAGGCTTACTGACTGGTTACTGACTGGGAGGCATGACTACTTACTATAA                   
&gt;M01825:384:000000000-BCYPK:1:1322:23543:1336 1:N:0:                   
    CAGGCATATTTGCACACTAGAGGCAAGTTACTGACTGGATATACTGAGGCATGGGAGGCATGACTCTATAAGGCTTACTGACTGGTTACTGACTG                   
&gt;M01825:384:000000000-BCYPK:1:1123:23543:1336 1:N:0: CCATGAGACCTGCATA                   
    CCATGAGACCTGCATACACTGTGGGAGGCATGACTCACTATAAACTACTACTGACTGGATATACTGAGGCATACTGACTGGTTACTTATAAGGCT                   
&gt;M01825:384:000000000-BCYPK:1:9872:23543:1336 1:N:0:TACCCAGCACCGCTTA                    
    TACCCAGCACCGCTTCCTTGACTTGGGAGGCATGACTCACTATAAACTACTACTGACTGGATATACTGAGGCATACTGACTGGTTACTTATAAGG
</code></pre>
<h2 id="adds-modules">Adds modules<a class="headerlink" href="#adds-modules" title="Permanent link">#</a></h2>
<p><strong>pre-requisite modules</strong>                  <br />
<em>none found</em>                 <br />
<strong>post-requisite modules</strong>                  <br />
<em>none found</em>                   </p>
<h2 id="docker">Docker<a class="headerlink" href="#docker" title="Permanent link">#</a></h2>
<p>If running in docker, this module will run in a docker container from this image:<br></p>
<pre><code>biolockjdevteam/biolockj_controller:v1.3.9
</code></pre>

<p>This can be modified using the following properties:<br>
<code>Demultiplexer.imageOwner</code><br>
<code>Demultiplexer.imageName</code><br>
<code>Demultiplexer.imageTag</code><br></p>
<h2 id="citation">Citation<a class="headerlink" href="#citation" title="Permanent link">#</a></h2>
<p>Module developed by Mike Sioda                 <br />
BioLockJ v1.3.9</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>2019 Fodor Lab</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
